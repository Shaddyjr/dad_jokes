<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>DAD JOKES</title>
		<!-- import React from CDN -->
		<script src="https://unpkg.com/react@17/umd/react.development.js"></script>
		<script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>

		<!-- import babel to use JSX -->
		<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

		<!-- custom js -->
		<script defer src="./resources/js/dadJokesAPI.js"></script>
	</head>
	<body>
		<div id="root"></div>
	</body>

	<script type="text/babel">
		// Renders an individual joke
		function Joke({ id, joke }) {
			return (
				<div>
					<header>{id}</header>
					<p>{joke}</p>
				</div>
			);
		}

		// Store state and renders joke table
		function JokesTable() {
			const [state, setState] = React.useState({ jokes: [], nextPage: 1 });
			console.log({ state });
			React.useEffect(async () => {
				const [newJokes, newNextPage] = await getJokes();
				setState((oldState) => ({
					...oldState,
					jokes: newJokes,
					nextPage: newNextPage,
				}));
			}, []);

			const { jokes, nextPage } = state;
			return (
				<div>
					{jokes.map(({ id, joke }) => {
						return <Joke key={id} id={id} joke={joke} />;
					})}
				</div>
			);
		}

		// Main app
		function App() {
			return <JokesTable />;
		}

		// call for React to render entire tree
		ReactDOM.render(<App />, document.getElementById("root"));
	</script>
</html>
